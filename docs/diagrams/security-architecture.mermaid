graph TB
    %% Authentication Layer
    subgraph "Authentication Layer"
        COGNITO["AWS Cognito<br/>(User Authentication)"]
        SSO["Enterprise SSO<br/>(SAML/OIDC)"]
        API_KEY["API Keys<br/>(Service Authentication)"]
    end

    %% Authorization Layer
    subgraph "Authorization Layer"
        IAM_ROLES["IAM Roles<br/>(Least Privilege)"]
        RBAC["Role-Based Access Control<br/>(User Permissions)"]
        RESOURCE_POLICY["Resource Policies<br/>(Data Access)"]
    end

    %% Encryption Layer
    subgraph "Encryption Layer"
        KMS_KEYS["KMS Keys<br/>(Data Encryption)"]
        TLS["TLS 1.3<br/>(Transport Security)"]
        FIELD_ENCRYPT["Field Level Encryption<br/>(Sensitive Data)"]
    end

    %% Network Security
    subgraph "Network Security"
        VPC["VPC<br/>(Private Networks)"]
        SG["Security Groups<br/>(Stateful Firewall)"]
        WAF["Web Application Firewall<br/>(OWASP Protection)"]
        CLOUDFRONT["CloudFront<br/>(DDoS Protection)"]
    end

    %% Application Security
    subgraph "Application Security"
        INPUT_VALIDATION["Input Validation<br/>(Data Sanitization)"]
        RATE_LIMITING["Rate Limiting<br/>(API Protection)"]
        CIRCUIT_BREAKER["Circuit Breaker<br/>(Failure Isolation)"]
        AUDIT_LOG["Audit Logging<br/>(Action Tracking)"]
    end

    %% Data Security
    subgraph "Data Security"
        DDB_ENCRYPT["DynamoDB Encryption<br/>(AES-256)"]
        S3_ENCRYPT["S3 Encryption<br/>(Server-Side)"]
        BACKUP_ENCRYPT["Backup Encryption<br/>(Cross-Region)"]
        PII_MASKING["PII Masking<br/>(Data Privacy)"]
    end

    %% Monitoring & Detection
    subgraph "Security Monitoring"
        GUARDIAN["Security Guardrails<br/>(Policy Enforcement)"]
        THREAT_DETECT["Threat Detection<br/>(Real-time Analysis)"]
        SECURITY_SCAN["Security Scanning<br/>(Infrastructure)"]
        COMPLIANCE_CHECK["Compliance Monitoring<br/>(Continuous)"]
    end

    %% Multi-Tenant Isolation
    subgraph "Multi-Tenant Isolation"
        TENANT_DATA["Tenant Data<br/>(Row-Level Security)"]
        TENANT_STORAGE["Tenant Storage<br/>(Bucket Isolation)"]
        TENANT_KEYS["Tenant Keys<br/>(Encryption Isolation)"]
        TENANT_NETWORK["Tenant Network<br/>(VPC Isolation)"]
    end

    %% Security Controls Flow
    COGNITO --> IAM_ROLES
    SSO --> RBAC
    API_KEY --> RESOURCE_POLICY
    
    IAM_ROLES --> KMS_KEYS
    RBAC --> TLS
    RESOURCE_POLICY --> FIELD_ENCRYPT

    VPC --> INPUT_VALIDATION
    SG --> RATE_LIMITING
    WAF --> CIRCUIT_BREAKER
    CLOUDFRONT --> AUDIT_LOG

    INPUT_VALIDATION --> DDB_ENCRYPT
    RATE_LIMITING --> S3_ENCRYPT
    CIRCUIT_BREAKER --> BACKUP_ENCRYPT
    AUDIT_LOG --> PII_MASKING

    DDB_ENCRYPT --> GUARDIAN
    S3_ENCRYPT --> THREAT_DETECT
    BACKUP_ENCRYPT --> SECURITY_SCAN
    PII_MASKING --> COMPLIANCE_CHECK

    GUARDIAN --> TENANT_DATA
    THREAT_DETECT --> TENANT_STORAGE
    SECURITY_SCAN --> TENANT_KEYS
    COMPLIANCE_CHECK --> TENANT_NETWORK

    %% Styling
    classDef auth fill:#e8f5e8
    classDef encryption fill:#e3f2fd
    classDef network fill:#fff3e0
    classDef app fill:#fce4ec
    classDef data fill:#f3e5f5
    classDef monitoring fill:#f1f8e9
    classDef isolation fill:#e0f2f1

    class COGNITO,SSO,API_KEY,IAM_ROLES,RBAC,RESOURCE_POLICY auth
    class KMS_KEYS,TLS,FIELD_ENCRYPT encryption
    class VPC,SG,WAF,CLOUDFRONT network
    class INPUT_VALIDATION,RATE_LIMITING,CIRCUIT_BREAKER,AUDIT_LOG app
    class DDB_ENCRYPT,S3_ENCRYPT,BACKUP_ENCRYPT,PII_MASKING data
    class GUARDIAN,THREAT_DETECT,SECURITY_SCAN,COMPLIANCE_CHECK monitoring
    class TENANT_DATA,TENANT_STORAGE,TENANT_KEYS,TENANT_NETWORK isolation
